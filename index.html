<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ルーム選択</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="indexPage">
  
<div id="intro">
  <video id="introVideo" autoplay muted playsinline>
    <source src="video/intro.mp4" type="video/mp4">
  </video>
  
  <button id="skipBtn">SKIP</button>
</div>

<div id="mainContent">
  <h2>ながおありがとう</h2>

  <p>名前：<input id="name"></p>
  <p>合言葉：<input id="room"></p>

  <button onclick="enter('play')">参加</button>
  <button onclick="enter('watch')">観戦</button>
</div>
  
<script>
document.addEventListener("DOMContentLoaded", () => {
  const intro = document.getElementById("intro");
  const video = document.getElementById("introVideo");
  const main = document.getElementById("mainContent");
  const skipBtn = document.getElementById("skipBtn");

/* スキップボタン */
  skipBtn.addEventListener("click", () => {
  localStorage.setItem("introSeen", "true");

  video.pause();
  video.currentTime = 0;

  intro.classList.add("fadeout");

  setTimeout(() => {
    intro.style.display = "none";
    main.style.display = "block";
  }, 300);
});

  video.addEventListener("ended", () => {
  skipBtn.style.display = "none";
});


  if (!intro || !video || !main) {
    console.error("intro / video / mainContent が見つかりません");
    return;
  }

  /* 初回チェック */
  if (sessionStorage.getItem("introSeen")) {
    intro.style.display = "none";
    main.style.display = "block";
    return;
  }

  /* 動画終了 */
  video.addEventListener("ended", () => {
    sessionStorage.setItem("introSeen", "true");
    intro.classList.add("fadeout");

    setTimeout(() => {
      intro.style.display = "none";
      main.style.display = "block";
    }, 1000);
  });

  /* 念のための保険 */
  setTimeout(() => {
    if (!localStorage.getItem("introSeen")) {
      localStorage.setItem("introSeen", "true");
      intro.classList.add("fadeout");

      setTimeout(() => {
        intro.style.display = "none";
        main.style.display = "block";
      }, 1000);
    }
  }, 5000);
});

function enter(mode) {
  const name = document.getElementById("name").value;
  const room = document.getElementById("room").value;

  if (!name || !room) {
    alert("名前と合言葉を入力してください");
    return;
  }

  location.href = `battle.html?mode=${mode}&name=${encodeURIComponent(name)}&room=${encodeURIComponent(room)}`;
}
</script>
</div>
</body>
</html>







